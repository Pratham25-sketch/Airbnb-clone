<% layout("/layouts/boilerplate.ejs")%>
<body>

<h2>Search Results</h2>
<% if(listings.length === 0){ %>
  <p>No listings found for "<%= query %>"</p>
<% } else { %>
  <% listings.forEach(list => { %>   <!-- ✅ Start loop -->
    <div class="card-body" style="display: inline-block;margin: 0.25rem;">
      <a class="card-info" href="/listings/<%=list._id%>">
        <div class="card" style="border: none;">
          <img src="<%= list.image.url %>" class="card-img" alt="..." 
               style="width: 17rem;height: 12rem;border-radius: 1.25rem;">
          <div class="card-img-overlay"></div>
          <div class="card-body">
            <h5 class="card-title" 
                style="font-size:0.80rem;margin: 0rem auto;margin-left: -1rem;margin-top: -1rem;">
                <%= list.title %>
            </h5>
            <p class="card-text" 
               style="opacity: 0.8;font-size: 0.79rem;margin: 0rem;margin-left: -1rem;">
              <%= list.price ? list.price.toLocaleString("en-IN") : "N/A" %> 
              <i class="gst" style="display: none;">+18% GST </i>
              for 2 nights &nbsp; 
              &#9733; <%= list.reviews.length 
                  ? (list.reviews.reduce((sum, r) => sum + r.rating, 0) / list.reviews.length).toFixed(1) 
                  : "No rating yet" %>
            </p>
          </div>
        </div>
      </a>
    </div>
  <% }) %>   <!-- ✅ End loop -->
<% } %>

</body>
